(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35eb5aae"],{"1a33":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"body"},[i("div",{staticClass:"map"},[i("map-range",{attrs:{"download-tips":t.downloadTips},on:{change:t.search,click:t.downloadJson}})],1),t._m(0),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTips,expression:"isShowTips"}],staticClass:"tips"},[t._v("正在下载，请耐心等待。。。(可打开控制台查看进度详情)")]),i("money-dialog",{ref:"dialog",on:{confirm:t.downloadAllJson}})],1)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"echarts"},[i("div",{attrs:{id:"map"}})])}],a=i("f499"),c=i.n(a),n=(i("7f7f"),i("ac6a"),i("386d"),i("7c39")),r=i.n(n),l=i("e724"),d=i("fb35"),h=i("0de6"),p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{staticClass:"github-corner",attrs:{href:"https://github.com/TangSY/echarts-map-demo","aria-label":"View source on GitHub",target:"_blank"}},[i("svg",{staticStyle:{fill:"#FD6C6C",color:"#fff",position:"absolute",top:"0",border:"0",right:"0"},attrs:{width:"80",height:"80",viewBox:"0 0 250 250","aria-hidden":"true"}},[i("path",{attrs:{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}}),i("path",{staticClass:"octo-arm",staticStyle:{"transform-origin":"130px 106px"},attrs:{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor"}}),i("path",{staticClass:"octo-body",attrs:{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor"}})])])},u=[],f={name:"Github",data:function(){return{}},mounted:function(){},computed:{},methods:{}},m=f,L=(i("9d61"),i("2877")),v=Object(L["a"])(m,p,u,!1,null,"8c423ad0",null),g=v.exports,C={name:"demo",components:{Github:g,MoneyDialog:h["a"],MapRange:d["a"]},data:function(){return{cityName:"中国",areaCode:1e4,geoJsonData:"",echartsMap:null,map:null,uimap:null,district:null,polygons:[],cityCode:1e5,citySelect:null,districtSelect:null,opts:{},areaData:{},mapData:[],zip:{},codeList:[],isCodeListLoadComplete:!1,downloadTips:"下载geoJson数据",isShowTips:!1}},mounted:function(){var t=this;this.zip=new r.a,this.citySelect=document.getElementById("city"),this.districtSelect=document.getElementById("district"),this.echartsMap=this.$echarts.init(document.getElementById("map")),this.echartsMap.on("click",this.echartsMapClick),this.map=new AMap.Map("container",{resizeEnable:!0,center:[116.30946,39.937629],zoom:3}),this.opts={subdistrict:1,showbiz:!1},this.district=new AMap.DistrictSearch(this.opts),this.district.search("中国",function(e,i){"complete"==e&&t.getData(i.districtList[0],"",1e5)})},watch:{isCodeListLoadComplete:function(t){t&&this.loadAllGeoJson()}},methods:{downloadMapCode:function(){var t=[],e=[],i=[],o=[],s=[],a=[];for(var n in o=this.codeList.filter(function(t){return"province"===t.level}),s=this.codeList.filter(function(t){return"city"===t.level}),a=this.codeList.filter(function(t){return"district"===t.level}),a.forEach(function(e){t.push({name:e.name,cityCode:e.code,fatherCode:"".concat(e.code.substring(0,4),"00"),children:[]})}),s){var r=[];for(var d in t)t[d].fatherCode==s[n].code&&r.push(t[d]);e.push({name:s[n].name,cityCode:s[n].code,fatherCode:"".concat(s[n].code.substring(0,2),"0000"),children:r})}for(var h in o){var p=[];for(var u in e)e[u].fatherCode==o[h].code&&p.push(e[u]);i.push({name:o[h].name,cityCode:o[h].code,fatherCode:"100000",children:p})}0!==i.length&&(this.zip.file("mapCode.json",c()(i)),this.downloadTips="文件打包压缩中...",this.zip.generateAsync({type:"blob"}).then(function(t){Object(l["a"])(t,"mapCode.zip")}))},echartsMapClick:function(t){var e=this;if(console.log(t),this.$ba.trackEvent("echartsMap","点击地图","".concat(t.data.name,"-").concat(t.data.cityCode)),"street"!=t.data.level){for(var i=0,o=this.polygons.length;i<o;i++)this.polygons[i].setMap(null);this.cityName=t.data.name,this.cityCode=t.data.cityCode,this.district.setLevel(t.data.level),this.district.setExtensions("all"),this.district.search(this.cityCode,function(i,o){"complete"===i&&e.getData(o.districtList[0],t.data.level,e.cityCode)})}},loadMapData:function(t){var e=this;AMapUI.loadUI(["geo/DistrictExplorer"],function(i){var o=window.districtExplorer=new i({eventSupport:!0,map:e.map});o.loadAreaNode(t,function(t,i){if(t)console.error(t);else{var o={};o.features=i.getSubFeatures(),e.loadMap(e.cityName,o),e.geoJsonData=o}})})},showTips:function(){var t=this;this.isShowTips=!0,setTimeout(function(){t.isShowTips=!1},3e3)},downloadJson:function(t){if("all"===t)return this.$ba.trackEvent("echartsMap","文件下载","打包下载全部"),void this.$refs.dialog.show();var e=new Blob([c()(this.geoJsonData)],{type:"text/plain;charset=utf-8"}),i=this.cityName;"code"===t&&(i=this.cityCode),this.$ba.trackEvent("echartsMap","文件下载",i),Object(l["a"])(e,"".concat(i,".geoJson"))},downloadAllJson:function(){this.showTips(),"下载geoJson数据"==this.downloadTips&&(this.codeList=[],this.downloadTips="获取数据中...",this.district.setExtensions("all"),console.log("开始递归循环获取地区code.."),this.loopSearch("中国"))},loopSearch:function(t){var e=this;setTimeout(function(){e.district.search(t,function(i,o){if("complete"==i)for(var s in console.log("".concat(t,"--获取成功")),o.districtList[0].districtList)e.codeList.push({name:o.districtList[0].districtList[s].name,code:o.districtList[0].districtList[s].adcode,level:o.districtList[0].districtList[s].level}),e.codeList.length>=428&&(console.log("code获取完成"),e.isCodeListLoadComplete=!0),o.districtList[0].districtList[s].adcode&&"city"!=o.districtList[0].districtList[s].level&&"district"!=o.districtList[0].districtList[s].level&&"street"!=o.districtList[0].districtList[s].level&&e.loopSearch(o.districtList[0].districtList[s].adcode);else console.log("".concat(t,"--第一次获取失败，正在尝试进行第二次获取")),e.district.search(t,function(i,o){if("complete"==i)for(var s in console.log("".concat(t,"--第二次获取成功")),o.districtList[0].districtList)e.codeList.push({name:o.districtList[0].districtList[s].name,code:o.districtList[0].districtList[s].adcode,level:o.districtList[0].districtList[s].level}),e.codeList.length>=428&&(console.log("code获取完成"),e.isCodeListLoadComplete=!0);else console.log("".concat(t,"--第二次获取失败，请联系email：t@tsy6.com"))})})},500)},loadAllGeoJson:function(){var t=this;console.log("开始加载geoJson数据"),AMapUI.loadUI(["geo/DistrictExplorer"],function(e){var i=window.districtExplorer=new e({eventSupport:!0,map:t.map}),o={},s=function(e){setTimeout(function(){i.loadAreaNode(t.codeList[e].code,function(i,s){if(i?(t.codeList[e].geo="error",console.log("".concat(t.codeList[e].name,"--").concat(t.codeList[e].code,"，geo 数据获取失败，高德地图的锅^_^"))):(o.features=s&&s.getSubFeatures()||"",t.codeList[e].geo=o,console.log("".concat(t.codeList[e].level,"--").concat(t.codeList[e].name,"--").concat(t.codeList[e].code,"，geo 数据获取成功，马上为你打包"))),"province"===t.codeList[e].level?t.zip.file("100000/".concat(t.codeList[e].code,".geoJson"),c()(o)):t.zip.file("100000/".concat(t.codeList[e].code.substring(0,2),"0000/").concat(t.codeList[e].code,".geoJson"),c()(o)),t.codeList.every(function(t){return t.geo})){console.log("ziped");var a="\r\n\n                                            项目源码github地址：https://github.com/TangSY/echarts-map-demo （欢迎star）\n                                            \r\n\n                                            个人空间：https://www.hxkj.vip （欢迎闲逛）\n                                            \r\n\n                                             Email：t@tsy6.com  （遇到问题可以反馈）\n                                         ";t.zip.file("readMe(sourceCode).txt",a),t.downloadTips="文件打包压缩中...",t.zip.generateAsync({type:"blob"}).then(function(e){Object(l["a"])(e,"geoJson数据包.zip"),t.downloadTips="下载geoJson数据",t.isCodeListLoadComplete=!1,t.$ba.trackEvent("echartsMap","文件下载","打包下载成功")})}})},100*e)};for(var a in t.codeList)s(a)})},loadMap:function(t,e){if(console.log(11111,t,e),e){this.$echarts.registerMap(t,e);var i={visualMap:{type:"piecewise",pieces:[{max:30,label:"安全",color:"#2c9a42"},{min:30,max:60,label:"警告",color:"#d08a00"},{min:60,label:"危险",color:"#c23c33"}],color:"#fff",textStyle:{color:"#fff"},visibility:"off"},series:[{name:"数据名称",type:"map",roam:!1,mapType:t,selectedMode:"single",showLegendSymbol:!1,visibility:"off",itemStyle:{normal:{color:"#ccc",areaColor:"#fff",borderColor:"#fff",borderWidth:.5,label:{show:!0,textStyle:{color:"rgb(249, 249, 249)"}}},emphasis:{areaColor:!1,borderColor:"#fff",areaStyle:{color:"#fff"},label:{show:!0,textStyle:{color:"rgb(249, 249, 249)"}}}},data:this.mapData}]};this.echartsMap.setOption(i)}},getData:function(t,e,i){var o=t.boundaries;if(o){for(var s=0,a=o.length;s<a;s++){var c=new AMap.Polygon({map:this.map,strokeWeight:1,strokeColor:"#0091ea",fillColor:"#80d8ff",fillOpacity:.2,path:o[s]});this.polygons.push(c)}this.map.setFitView()}"province"===e?(this.citySelect.innerHTML="",this.districtSelect.innerHTML=""):"city"===e&&(this.districtSelect.innerHTML="");var n=t.districtList;if(n){var r=new Option("--请选择--"),l=n[0].level;if("street"===l){var d=this.geoJsonData.features,h={};for(var p in d)d[p].properties.name==this.cityName&&(h.features=[].concat(d[p]));return this.mapData=[],this.mapData.push({name:this.cityName,value:100*Math.random(),level:l}),this.loadMap(this.cityName,h),void(this.geoJsonData=h)}var u=document.querySelector("#"+l);u.add(r),this.mapData=[];for(s=0,a=n.length;s<a;s++){var f=n[s].name,m=n[s].adcode;this.mapData.push({name:f,value:100*Math.random(),cityCode:m,level:l});var L=n[s].level;r=new Option(f),r.setAttribute("value",L),r.center=n[s].center,r.adcode=n[s].adcode,u.add(r)}this.loadMapData(i),this.areaData[l]=u}},search:function(t){for(var e=this,i=this.areaData[t],o=0,s=this.polygons.length;o<s;o++)this.polygons[o].setMap(null);var a=i[i.options.selectedIndex],c=a.text,n=a.adcode;this.cityName=c,this.cityCode=n,this.$ba.trackEvent("echartsMap","筛选地图","".concat(this.cityName,"-").concat(this.cityCode)),this.district.setLevel(a.value),this.district.setExtensions("all"),this.district.search(n,function(t,o){"complete"===t&&e.getData(o.districtList[0],i.id,n)})}}},y=C,b=(i("584b"),Object(L["a"])(y,o,s,!1,null,"22d70114",null));e["default"]=b.exports},"584b":function(t,e,i){"use strict";var o=i("b463"),s=i.n(o);s.a},"9d61":function(t,e,i){"use strict";var o=i("bb18"),s=i.n(o);s.a},ac6a:function(t,e,i){for(var o=i("cadf"),s=i("0d58"),a=i("2aba"),c=i("7726"),n=i("32e9"),r=i("84f2"),l=i("2b4c"),d=l("iterator"),h=l("toStringTag"),p=r.Array,u={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=s(u),m=0;m<f.length;m++){var L,v=f[m],g=u[v],C=c[v],y=C&&C.prototype;if(y&&(y[d]||n(y,d,p),y[h]||n(y,h,v),r[v]=p,g))for(L in o)y[L]||a(y,L,o[L],!0)}},b463:function(t,e,i){},bb18:function(t,e,i){}}]);
//# sourceMappingURL=chunk-35eb5aae.2e3de456.js.map